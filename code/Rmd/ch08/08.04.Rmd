## 8.4 入力変数の数とモデルの良さ

```{r}
library(caret)
library(tidyverse)
my_url <- str_c("https://raw.githubusercontent.com",
                "/taroyabuki/fromzero/master/data/wine.csv")
my_data <- read_csv(my_url)

n <- nrow(my_data)
my_data2 <- my_data %>% mutate(rand1 = runif(n), rand2 = runif(n))
head(my_data2)
#> # A tibble: 6 x 7
#>   LPRICE2 WRAIN DEGREES HRAIN TIME_SV  rand1 rand2
#>     <dbl> <dbl>   <dbl> <dbl>   <dbl>  <dbl> <dbl>
#> 1  -0.999   600    17.1   160      31 0.189  0.601
#> 2  -0.454   690    16.7    80      30 0.843  0.283
#> 3  -0.808   502    17.2   130      28 0.723  0.846
#> 4  -1.51    420    16.1   110      26 0.0472 0.406
#> 5  -1.72    582    16.4   187      25 0.812  0.479
#> 6  -0.418   485    17.5   187      24 0.105  0.801
```

```{r}
my_model2 <- train(form = LPRICE2 ~ ., data = my_data2, method = "lm",
                   trControl = trainControl(method = "LOOCV"))
y  <- my_data2$LPRICE2
y_ <- my_model2 %>% predict(my_data2)

RMSE(y_, y)
#> [1] 0.2532344 # RMSE（訓練）

my_model2$results$RMSE
#> [1] 0.3550712 # RMSE（検証）
```

