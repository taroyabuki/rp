#### 7.3.3.1 データの用意

```{r}
library(caret)
library(tidyverse)
my_data <- cars
```

#### 7.3.3.2 訓練

```{r}
my_model <- train(form = dist ~ speed, # モデル式（出力変数と入力変数の関係）
                  data = my_data,      # データ
                  method = "lm")       # 手法
```

```{r}
coef(my_model$finalModel)
#> (Intercept)       speed 
#> -17.579095    3.932409 
```

#### 7.3.3.3 予測

```{r}
tmp <- data.frame(speed = 21.5)
my_model %>% predict(tmp)
#>        1 
#> 66.96769 
```

#### 7.3.3.4 モデルの可視化

```{r}
f <- function(x) { my_model %>% predict(data.frame(speed = x)) }
```

```{r}
my_data %>%
  ggplot(aes(x = speed,
             y = dist,
             color = "data")) +
  geom_point() +
  stat_function(
    fun = f,
    mapping = aes(color = "model"))
```

